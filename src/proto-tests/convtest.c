#include <stdio.h>
#include <stdlib.h>

#define CONV_SIZE 180
#define RB_SIZE (CONV_SIZE*2)
#define BUFF_SIZE 4096

int8_t a[RB_SIZE];
int8_t b[RB_SIZE];

int16_t conv_matr[CONV_SIZE][CONV_SIZE];

int16_t r[CONV_SIZE];

int16_t offset;

int16_t acorr(int8_t ai, int8_t bi)
{
    a[offset%RB_SIZE] = ai;
    b[offset%RB_SIZE] = bi;

    for (int i = 0; i < ; i++)
    {

    }

    offset = offset + 1;
    return 0;
}

void init()
{
    offset = 0;
}

int main()
{
    FILE *f;
    f = fopen("../../testdata8bit9600.raw", "rb");
        if (f == NULL){
        printf("Error reading file f\n");
        exit (0);
    }

    int8_t buffer[BUFF_SIZE];

    size_t bytes_read = fread(buffer, 1, BUFF_SIZE, f);
    while (bytes_read) {
        for (int i = 0; i < bytes_read / 2; i++) {
            acorr(buffer[i*2+0], buffer[i*2+1]);
            printf("%02X ", buffer[i]);
        }
        bytes_read = fread(buffer, 1, BUFF_SIZE0, f);
    }

    fclose(f);
    return 0;
}

/*

RB_SIZE 8
CONV_SIZE 4

i = 5
  0  1  2  3  4  5  x  x
0 00 10 20 .. .. .. .. ..
1 01 11 21 31 .. .. .. ..
2 02 12 22 32 .. .. .. ..
3 .. 13 23 33 .. .. .. ..
4 .. .. 24 34 .. .. .. ..
5 .. .. .. 35 .. .. .. ..
x 0x .. .. .. .. .. .. ..
x 0x 1x .. .. .. .. .. ..

i = 6
  0  1  2  3  4  5  6  x
0 .. 10 20 .. .. .. .. ..
1 .. 11 21 31 .. .. .. ..
2 .. 12 22 32 42 .. .. ..
3 .. 13 23 33 43 .. .. ..
4 .. .. 24 34 44 .. .. ..
5 .. .. .. 35 45 .. .. ..
6 .. .. .. .. 46 .. .. ..
x .. 1x .. .. .. .. .. ..

i = 7
j:[(RB_SIZE-CONV_SIZE)/2..(RB_SIZE+CONV_SIZE)/2-1]  k:[j-(CONV_SIZE/2)..j+(CONV_SIZE/2)-1]
j<-i-(RB_SIZE-CONV_SIZE/2)
  0  1  2. 3. 4. 5. 6  7
0 .. .. 20 .. .. .. .. .. 20+31+42+53
1 .. .. 21 31 .. .. .. .. 21+32+43+54
2 .. .. 22 32 42 .. .. .. 22+33+44+55
3 .. .. 23 33 43 53 .. .. 23+34+45+56
4 .. .. .. 34 44 54 .. ..
5 .. .. .. .. 45 55 .. ..
6 .. .. .. .. .. 56 .. ..
7 .. .. .. .. .. .. .. ..

i = 8
  8  1  2  3  4  5  6  7
8 .. .. .. .. .. .. .. ..
1 .. .. .. 31 .. .. .. .. 31+42+53+64
2 .. .. .. 32 42 .. .. .. 32+43+54+65
3 .. .. .. 33 43 53 .. .. 33+44+55+66
4 .. .. .. 34 44 54 64 .. 34+45+56+67
5 .. .. .. .. 45 55 65 .. 
6 .. .. .. .. .. 56 66 ..
7 .. .. .. .. .. .. 67 ..

  8  9  2  3  4  5  6  7
8 .. .. .. .. .. .. 68 78
9 .. .. .. .. .. .. .. 79
2 .. .. .. .. 42 .. .. .. 42+53+64+75
3 .. .. .. .. 43 53 .. .. 43+54+65+76
4 .. .. .. .. 44 54 64 .. 44+55+66+77
5 .. .. .. .. 45 55 65 75 45+56+67+78
6 .. .. .. .. 46 56 66 76 46+57+68+79
7 .. .. .. .. .. 57 67 77

  8  9  A  3  4  5  6  7
8 88 .. .. .. .. .. 68 78
9 89 .. .. .. .. .. .. 79
A 8A .. .. .. .. .. .. ..
3 .. .. .. .. .. 53 .. .. 53+64+75+86
4 .. .. .. .. .. 54 64 .. 54+65+76+87
5 .. .. .. .. .. 55 65 75 55+66+77+88
6 86 .. .. .. .. 56 66 76 56+67+78+89
7 87 .. .. .. .. 57 67 77 57+68+79+8A

*/